import{a as R,t as F}from"./StationDTO-BRxKE2Z_.js";import{S as d}from"./StationCode-BmEn2_u1.js";import"./Identifier-Yjt1Lx6E.js";import"./Result-BKWviScr.js";function I(i,e,t,o){return{success:!0,fare:t.amount,originId:i,destinationId:e,distance:o}}function r(i,e,t){return{success:!1,originId:i,destinationId:e,error:t}}class y{constructor(e,t,o){this.stationRepository=e,this.fareRepository=t,this.fareCalculationService=o}async execute(e){try{const t=d.create(e.originId);if(t.isFailure)return r(e.originId,e.destinationId,t.error.message);const o=d.create(e.destinationId);if(o.isFailure)return r(e.originId,e.destinationId,o.error.message);const c=t.value,f=o.value,[a,s,l]=await Promise.all([this.stationRepository.findByCode(c),this.stationRepository.findByCode(f),this.fareRepository.getFareMatrix()]);if(!a)return r(e.originId,e.destinationId,`Origin station not found: ${e.originId}`);if(!s)return r(e.originId,e.destinationId,`Destination station not found: ${e.destinationId}`);const n=this.fareCalculationService.calculateFare(a,s,l);if(!n)return r(e.originId,e.destinationId,"Unable to calculate fare");const u=a.distanceTo(s);return I(e.originId,e.destinationId,n,u)}catch(t){return r(e.originId,e.destinationId,t instanceof Error?t.message:"Unknown error occurred")}}}export{y as CalculateFareUseCase,r as createFailureOutput,I as createSuccessOutput,R as toStationDTO,F as toStationDTOs};
