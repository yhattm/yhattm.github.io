class d{async process(e){const r=e.size,o=await this.createImageFromBlob(e),t=await this.compressImage(o,{maxWidth:1920,maxHeight:1080,quality:.8}),a=await this.compressImage(o,{maxWidth:200,maxHeight:200,quality:.7});return console.log(`ðŸ“¸ Image processed: ${this.formatBytes(r)} â†’ ${this.formatBytes(t.size)}`),{compressed:t,thumbnail:a,originalSize:r,compressedSize:t.size}}async blobToArrayBuffer(e){return new Promise((r,o)=>{const t=new FileReader;t.onload=()=>r(t.result),t.onerror=o,t.readAsArrayBuffer(e)})}arrayBufferToBlob(e,r){return new Blob([e],{type:r})}createImageFromBlob(e){return new Promise((r,o)=>{const t=new Image,a=URL.createObjectURL(e);t.onload=()=>{URL.revokeObjectURL(a),r(t)},t.onerror=()=>{URL.revokeObjectURL(a),o(new Error("Failed to load image"))},t.src=a})}async compressImage(e,r){const{maxWidth:o,maxHeight:t,quality:a}=r,n=Math.min(1,o/e.width,t/e.height),s=document.createElement("canvas");s.width=Math.floor(e.width*n),s.height=Math.floor(e.height*n);const i=s.getContext("2d");if(!i)throw new Error("Failed to get canvas context");return i.drawImage(e,0,0,s.width,s.height),new Promise((h,m)=>{s.toBlob(c=>{c?h(c):m(new Error("Failed to compress image"))},"image/jpeg",a)})}formatBytes(e){if(e===0)return"0 Bytes";const r=1024,o=["Bytes","KB","MB","GB"],t=Math.floor(Math.log(e)/Math.log(r));return Math.round(e/Math.pow(r,t)*100)/100+" "+o[t]}}export{d as BrowserImageProcessor};
