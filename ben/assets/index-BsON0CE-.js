var te={exports:{}},Se;function Je(){return Se||(Se=1,(function(s){var e=(function(r){var i=Object.prototype,c=i.hasOwnProperty,u=Object.defineProperty||function(n,t,o){n[t]=o.value},g,k=typeof Symbol=="function"?Symbol:{},M=k.iterator||"@@iterator",N=k.asyncIterator||"@@asyncIterator",E=k.toStringTag||"@@toStringTag";function S(n,t,o){return Object.defineProperty(n,t,{value:o,enumerable:!0,configurable:!0,writable:!0}),n[t]}try{S({},"")}catch{S=function(t,o,h){return t[o]=h}}function T(n,t,o,h){var f=t&&t.prototype instanceof R?t:R,y=Object.create(f.prototype),C=new H(h||[]);return u(y,"_invoke",{value:X(n,o,C)}),y}r.wrap=T;function q(n,t,o){try{return{type:"normal",arg:n.call(t,o)}}catch(h){return{type:"throw",arg:h}}}var $="suspendedStart",L="suspendedYield",a="executing",l="completed",w={};function R(){}function d(){}function b(){}var A={};S(A,M,function(){return this});var D=Object.getPrototypeOf,j=D&&D(D(J([])));j&&j!==i&&c.call(j,M)&&(A=j);var B=b.prototype=R.prototype=Object.create(A);d.prototype=b,u(B,"constructor",{value:b,configurable:!0}),u(b,"constructor",{value:d,configurable:!0}),d.displayName=S(b,E,"GeneratorFunction");function x(n){["next","throw","return"].forEach(function(t){S(n,t,function(o){return this._invoke(t,o)})})}r.isGeneratorFunction=function(n){var t=typeof n=="function"&&n.constructor;return t?t===d||(t.displayName||t.name)==="GeneratorFunction":!1},r.mark=function(n){return Object.setPrototypeOf?Object.setPrototypeOf(n,b):(n.__proto__=b,S(n,E,"GeneratorFunction")),n.prototype=Object.create(B),n},r.awrap=function(n){return{__await:n}};function K(n,t){function o(y,C,_,P){var I=q(n[y],n,C);if(I.type==="throw")P(I.arg);else{var m=I.arg,v=m.value;return v&&typeof v=="object"&&c.call(v,"__await")?t.resolve(v.__await).then(function(O){o("next",O,_,P)},function(O){o("throw",O,_,P)}):t.resolve(v).then(function(O){m.value=O,_(m)},function(O){return o("throw",O,_,P)})}}var h;function f(y,C){function _(){return new t(function(P,I){o(y,C,P,I)})}return h=h?h.then(_,_):_()}u(this,"_invoke",{value:f})}x(K.prototype),S(K.prototype,N,function(){return this}),r.AsyncIterator=K,r.async=function(n,t,o,h,f){f===void 0&&(f=Promise);var y=new K(T(n,t,o,h),f);return r.isGeneratorFunction(t)?y:y.next().then(function(C){return C.done?C.value:y.next()})};function X(n,t,o){var h=$;return function(y,C){if(h===a)throw new Error("Generator is already running");if(h===l){if(y==="throw")throw C;return V()}for(o.method=y,o.arg=C;;){var _=o.delegate;if(_){var P=W(_,o);if(P){if(P===w)continue;return P}}if(o.method==="next")o.sent=o._sent=o.arg;else if(o.method==="throw"){if(h===$)throw h=l,o.arg;o.dispatchException(o.arg)}else o.method==="return"&&o.abrupt("return",o.arg);h=a;var I=q(n,t,o);if(I.type==="normal"){if(h=o.done?l:L,I.arg===w)continue;return{value:I.arg,done:o.done}}else I.type==="throw"&&(h=l,o.method="throw",o.arg=I.arg)}}}function W(n,t){var o=t.method,h=n.iterator[o];if(h===g)return t.delegate=null,o==="throw"&&n.iterator.return&&(t.method="return",t.arg=g,W(n,t),t.method==="throw")||o!=="return"&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+o+"' method")),w;var f=q(h,n.iterator,t.arg);if(f.type==="throw")return t.method="throw",t.arg=f.arg,t.delegate=null,w;var y=f.arg;if(!y)return t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,w;if(y.done)t[n.resultName]=y.value,t.next=n.nextLoc,t.method!=="return"&&(t.method="next",t.arg=g);else return y;return t.delegate=null,w}x(B),S(B,E,"Generator"),S(B,M,function(){return this}),S(B,"toString",function(){return"[object Generator]"});function z(n){var t={tryLoc:n[0]};1 in n&&(t.catchLoc=n[1]),2 in n&&(t.finallyLoc=n[2],t.afterLoc=n[3]),this.tryEntries.push(t)}function Y(n){var t=n.completion||{};t.type="normal",delete t.arg,n.completion=t}function H(n){this.tryEntries=[{tryLoc:"root"}],n.forEach(z,this),this.reset(!0)}r.keys=function(n){var t=Object(n),o=[];for(var h in t)o.push(h);return o.reverse(),function f(){for(;o.length;){var y=o.pop();if(y in t)return f.value=y,f.done=!1,f}return f.done=!0,f}};function J(n){if(n){var t=n[M];if(t)return t.call(n);if(typeof n.next=="function")return n;if(!isNaN(n.length)){var o=-1,h=function f(){for(;++o<n.length;)if(c.call(n,o))return f.value=n[o],f.done=!1,f;return f.value=g,f.done=!0,f};return h.next=h}}return{next:V}}r.values=J;function V(){return{value:g,done:!0}}return H.prototype={constructor:H,reset:function(n){if(this.prev=0,this.next=0,this.sent=this._sent=g,this.done=!1,this.delegate=null,this.method="next",this.arg=g,this.tryEntries.forEach(Y),!n)for(var t in this)t.charAt(0)==="t"&&c.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=g)},stop:function(){this.done=!0;var n=this.tryEntries[0],t=n.completion;if(t.type==="throw")throw t.arg;return this.rval},dispatchException:function(n){if(this.done)throw n;var t=this;function o(P,I){return y.type="throw",y.arg=n,t.next=P,I&&(t.method="next",t.arg=g),!!I}for(var h=this.tryEntries.length-1;h>=0;--h){var f=this.tryEntries[h],y=f.completion;if(f.tryLoc==="root")return o("end");if(f.tryLoc<=this.prev){var C=c.call(f,"catchLoc"),_=c.call(f,"finallyLoc");if(C&&_){if(this.prev<f.catchLoc)return o(f.catchLoc,!0);if(this.prev<f.finallyLoc)return o(f.finallyLoc)}else if(C){if(this.prev<f.catchLoc)return o(f.catchLoc,!0)}else if(_){if(this.prev<f.finallyLoc)return o(f.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(n,t){for(var o=this.tryEntries.length-1;o>=0;--o){var h=this.tryEntries[o];if(h.tryLoc<=this.prev&&c.call(h,"finallyLoc")&&this.prev<h.finallyLoc){var f=h;break}}f&&(n==="break"||n==="continue")&&f.tryLoc<=t&&t<=f.finallyLoc&&(f=null);var y=f?f.completion:{};return y.type=n,y.arg=t,f?(this.method="next",this.next=f.finallyLoc,w):this.complete(y)},complete:function(n,t){if(n.type==="throw")throw n.arg;return n.type==="break"||n.type==="continue"?this.next=n.arg:n.type==="return"?(this.rval=this.arg=n.arg,this.method="return",this.next="end"):n.type==="normal"&&t&&(this.next=t),w},finish:function(n){for(var t=this.tryEntries.length-1;t>=0;--t){var o=this.tryEntries[t];if(o.finallyLoc===n)return this.complete(o.completion,o.afterLoc),Y(o),w}},catch:function(n){for(var t=this.tryEntries.length-1;t>=0;--t){var o=this.tryEntries[t];if(o.tryLoc===n){var h=o.completion;if(h.type==="throw"){var f=h.arg;Y(o)}return f}}throw new Error("illegal catch attempt")},delegateYield:function(n,t,o){return this.delegate={iterator:J(n),resultName:t,nextLoc:o},this.method==="next"&&(this.arg=g),w}},r})(s.exports);try{regeneratorRuntime=e}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=e:Function("r","regeneratorRuntime = r")(e)}})(te)),te.exports}var re,be;function Re(){return be||(be=1,re=(s,e)=>`${s}-${e}-${Math.random().toString(16).slice(3,8)}`),re}var ne,Oe;function Ke(){if(Oe)return ne;Oe=1;const s=Re();let e=0;return ne=({id:r,action:i,payload:c={}})=>{let u=r;return typeof u>"u"&&(u=s("Job",e),e+=1),{id:u,action:i,payload:c}},ne}var Z={},Ee;function ke(){if(Ee)return Z;Ee=1;let s=!1;return Z.logging=s,Z.setLogging=e=>{s=e},Z.log=(...e)=>s?console.log.apply(this,e):null,Z}var oe,Te;function Ze(){if(Te)return oe;Te=1;const s=Ke(),{log:e}=ke(),r=Re();let i=0;return oe=()=>{const c=r("Scheduler",i),u={},g={};let k=[];i+=1;const M=()=>k.length,N=()=>Object.keys(u).length,E=()=>{if(k.length!==0){const L=Object.keys(u);for(let a=0;a<L.length;a+=1)if(typeof g[L[a]]>"u"){k[0](u[L[a]]);break}}},S=(L,a)=>new Promise((l,w)=>{const R=s({action:L,payload:a});k.push(async d=>{k.shift(),g[d.id]=R;try{l(await d[L].apply(this,[...a,R.id]))}catch(b){w(b)}finally{delete g[d.id],E()}}),e(`[${c}]: Add ${R.id} to JobQueue`),e(`[${c}]: JobQueue length=${k.length}`),E()});return{addWorker:L=>(u[L.id]=L,e(`[${c}]: Add ${L.id}`),e(`[${c}]: Number of workers=${N()}`),E(),L.id),addJob:async(L,...a)=>{if(N()===0)throw Error(`[${c}]: You need to have at least one worker before adding jobs`);return S(L,a)},terminate:async()=>{Object.keys(u).forEach(async L=>{await u[L].terminate()}),k=[]},getQueueLen:M,getNumWorkers:N}},oe}function Ve(s){throw new Error('Could not dynamically require "'+s+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var ae,Ae;function Qe(){return Ae||(Ae=1,ae=s=>{const e={};return typeof WorkerGlobalScope<"u"?e.type="webworker":typeof document=="object"?e.type="browser":typeof process=="object"&&typeof Ve=="function"&&(e.type="node"),typeof s>"u"?e:e[s]}),ae}var ie,Ce;function Xe(){if(Ce)return ie;Ce=1;const e=Qe()("type")==="browser"?r=>new URL(r,window.location.href).href:r=>r;return ie=r=>{const i={...r};return["corePath","workerPath","langPath"].forEach(c=>{r[c]&&(i[c]=e(i[c]))}),i},ie}var se,_e;function xe(){return _e||(_e=1,se={TESSERACT_ONLY:0,LSTM_ONLY:1,TESSERACT_LSTM_COMBINED:2,DEFAULT:3}),se}const et="6.0.1",tt={version:et};var ce,Ie;function rt(){return Ie||(Ie=1,ce={workerBlobURL:!0,logger:()=>{}}),ce}var le,Me;function nt(){if(Me)return le;Me=1;const s=tt.version;return le={...rt(),workerPath:`https://cdn.jsdelivr.net/npm/tesseract.js@v${s}/dist/worker.min.js`},le}var ue,Ne;function ot(){return Ne||(Ne=1,ue=({workerPath:s,workerBlobURL:e})=>{let r;if(Blob&&URL&&e){const i=new Blob([`importScripts("${s}");`],{type:"application/javascript"});r=new Worker(URL.createObjectURL(i))}else r=new Worker(s);return r}),ue}var fe,qe;function at(){return qe||(qe=1,fe=s=>{s.terminate()}),fe}var he,Pe;function it(){return Pe||(Pe=1,he=(s,e)=>{s.onmessage=({data:r})=>{e(r)}}),he}var de,$e;function st(){return $e||($e=1,de=async(s,e)=>{s.postMessage(e)}),de}var ge,ze;function ct(){if(ze)return ge;ze=1;const s=r=>new Promise((i,c)=>{const u=new FileReader;u.onload=()=>{i(u.result)},u.onerror=({target:{error:{code:g}}})=>{c(Error(`File could not be read! Code=${g}`))},u.readAsArrayBuffer(r)}),e=async r=>{let i=r;if(typeof r>"u")return"undefined";if(typeof r=="string")/data:image\/([a-zA-Z]*);base64,([^"]*)/.test(r)?i=atob(r.split(",")[1]).split("").map(c=>c.charCodeAt(0)):i=await(await fetch(r)).arrayBuffer();else if(typeof HTMLElement<"u"&&r instanceof HTMLElement)r.tagName==="IMG"&&(i=await e(r.src)),r.tagName==="VIDEO"&&(i=await e(r.poster)),r.tagName==="CANVAS"&&await new Promise(c=>{r.toBlob(async u=>{i=await s(u),c()})});else if(typeof OffscreenCanvas<"u"&&r instanceof OffscreenCanvas){const c=await r.convertToBlob();i=await s(c)}else(r instanceof File||r instanceof Blob)&&(i=await s(r));return new Uint8Array(i)};return ge=e,ge}var pe,Ge;function lt(){if(Ge)return pe;Ge=1;const s=nt(),e=ot(),r=at(),i=it(),c=st(),u=ct();return pe={defaultOptions:s,spawnWorker:e,terminateWorker:r,onMessage:i,send:c,loadImage:u},pe}var me,Ue;function Ye(){if(Ue)return me;Ue=1;const s=Xe(),e=Ke(),{log:r}=ke(),i=Re(),c=xe(),{defaultOptions:u,spawnWorker:g,terminateWorker:k,onMessage:M,loadImage:N,send:E}=lt();let S=0;return me=async(T="eng",q=c.LSTM_ONLY,$={},L={})=>{const a=i("Worker",S),{logger:l,errorHandler:w,...R}=s({...u,...$}),d={},b=typeof T=="string"?T.split("+"):T;let A=q,D=L;const j=[c.DEFAULT,c.LSTM_ONLY].includes(q)&&!R.legacyCore;let B,x;const K=new Promise((m,v)=>{x=m,B=v}),X=m=>{B(m.message)};let W=g(R);W.onerror=X,S+=1;const z=({id:m,action:v,payload:O})=>new Promise((G,U)=>{r(`[${a}]: Start ${m}, action=${v}`);const F=`${v}-${m}`;d[F]={resolve:G,reject:U},E(W,{workerId:a,jobId:m,action:v,payload:O})}),Y=()=>console.warn("`load` is depreciated and should be removed from code (workers now come pre-loaded)"),H=m=>z(e({id:m,action:"load",payload:{options:{lstmOnly:j,corePath:R.corePath,logging:R.logging}}})),J=(m,v,O)=>z(e({id:O,action:"FS",payload:{method:"writeFile",args:[m,v]}})),V=(m,v)=>z(e({id:v,action:"FS",payload:{method:"readFile",args:[m,{encoding:"utf8"}]}})),n=(m,v)=>z(e({id:v,action:"FS",payload:{method:"unlink",args:[m]}})),t=(m,v,O)=>z(e({id:O,action:"FS",payload:{method:m,args:v}})),o=(m,v)=>z(e({id:v,action:"loadLanguage",payload:{langs:m,options:{langPath:R.langPath,dataPath:R.dataPath,cachePath:R.cachePath,cacheMethod:R.cacheMethod,gzip:R.gzip,lstmOnly:[c.DEFAULT,c.LSTM_ONLY].includes(A)&&!R.legacyLang}}})),h=(m,v,O,G)=>z(e({id:G,action:"initialize",payload:{langs:m,oem:v,config:O}})),f=(m="eng",v,O,G)=>{if(j&&[c.TESSERACT_ONLY,c.TESSERACT_LSTM_COMBINED].includes(v))throw Error("Legacy model requested but code missing.");const U=v||A;A=U;const F=O||D;D=F;const ee=(typeof m=="string"?m.split("+"):m).filter(He=>!b.includes(He));return b.push(...ee),ee.length>0?o(ee,G).then(()=>h(m,U,F,G)):h(m,U,F,G)},y=(m={},v)=>z(e({id:v,action:"setParameters",payload:{params:m}})),C=async(m,v={},O={text:!0},G)=>z(e({id:G,action:"recognize",payload:{image:await N(m),options:v,output:O}})),_=async(m,v)=>{if(j)throw Error("`worker.detect` requires Legacy model, which was not loaded.");return z(e({id:v,action:"detect",payload:{image:await N(m)}}))},P=async()=>(W!==null&&(k(W),W=null),Promise.resolve());M(W,({workerId:m,jobId:v,status:O,action:G,data:U})=>{const F=`${G}-${v}`;if(O==="resolve")r(`[${m}]: Complete ${v}`),d[F].resolve({jobId:v,data:U}),delete d[F];else if(O==="reject")if(d[F].reject(U),delete d[F],G==="load"&&B(U),w)w(U);else throw Error(U);else O==="progress"&&l({...U,userJobId:v})});const I={id:a,worker:W,load:Y,writeText:J,readText:V,removeFile:n,FS:t,reinitialize:f,setParameters:y,recognize:C,detect:_,terminate:P};return H().then(()=>o(T)).then(()=>h(T,q,L)).then(()=>x(I)).catch(()=>{}),K},me}var ve,De;function ut(){if(De)return ve;De=1;const s=Ye();return ve={recognize:async(i,c,u)=>{const g=await s(c,1,u);return g.recognize(i).finally(async()=>{await g.terminate()})},detect:async(i,c)=>{const u=await s("osd",0,c);return u.detect(i).finally(async()=>{await u.terminate()})}},ve}var we,je;function ft(){return je||(je=1,we={AFR:"afr",AMH:"amh",ARA:"ara",ASM:"asm",AZE:"aze",AZE_CYRL:"aze_cyrl",BEL:"bel",BEN:"ben",BOD:"bod",BOS:"bos",BUL:"bul",CAT:"cat",CEB:"ceb",CES:"ces",CHI_SIM:"chi_sim",CHI_TRA:"chi_tra",CHR:"chr",CYM:"cym",DAN:"dan",DEU:"deu",DZO:"dzo",ELL:"ell",ENG:"eng",ENM:"enm",EPO:"epo",EST:"est",EUS:"eus",FAS:"fas",FIN:"fin",FRA:"fra",FRK:"frk",FRM:"frm",GLE:"gle",GLG:"glg",GRC:"grc",GUJ:"guj",HAT:"hat",HEB:"heb",HIN:"hin",HRV:"hrv",HUN:"hun",IKU:"iku",IND:"ind",ISL:"isl",ITA:"ita",ITA_OLD:"ita_old",JAV:"jav",JPN:"jpn",KAN:"kan",KAT:"kat",KAT_OLD:"kat_old",KAZ:"kaz",KHM:"khm",KIR:"kir",KOR:"kor",KUR:"kur",LAO:"lao",LAT:"lat",LAV:"lav",LIT:"lit",MAL:"mal",MAR:"mar",MKD:"mkd",MLT:"mlt",MSA:"msa",MYA:"mya",NEP:"nep",NLD:"nld",NOR:"nor",ORI:"ori",PAN:"pan",POL:"pol",POR:"por",PUS:"pus",RON:"ron",RUS:"rus",SAN:"san",SIN:"sin",SLK:"slk",SLV:"slv",SPA:"spa",SPA_OLD:"spa_old",SQI:"sqi",SRP:"srp",SRP_LATN:"srp_latn",SWA:"swa",SWE:"swe",SYR:"syr",TAM:"tam",TEL:"tel",TGK:"tgk",TGL:"tgl",THA:"tha",TIR:"tir",TUR:"tur",UIG:"uig",UKR:"ukr",URD:"urd",UZB:"uzb",UZB_CYRL:"uzb_cyrl",VIE:"vie",YID:"yid"}),we}var ye,Be;function ht(){return Be||(Be=1,ye={OSD_ONLY:"0",AUTO_OSD:"1",AUTO_ONLY:"2",AUTO:"3",SINGLE_COLUMN:"4",SINGLE_BLOCK_VERT_TEXT:"5",SINGLE_BLOCK:"6",SINGLE_LINE:"7",SINGLE_WORD:"8",CIRCLE_WORD:"9",SINGLE_CHAR:"10",SPARSE_TEXT:"11",SPARSE_TEXT_OSD:"12",RAW_LINE:"13"}),ye}var Le,We;function dt(){if(We)return Le;We=1,Je();const s=Ze(),e=Ye(),r=ut(),i=ft(),c=xe(),u=ht(),{setLogging:g}=ke();return Le={languages:i,OEM:c,PSM:u,createScheduler:s,createWorker:e,setLogging:g,...r},Le}var gt=dt();const p={email:/[\w.+-]+@[\w.-]+\.[a-zA-Z]{2,}/gi,phone:/(\+?886[-.\s])?\(?0?\d{2,4}\)?[-.\s]?\d{3,4}[-.\s]?\d{3,4}|(\+?\d{1,3}[-.\s])?\(?\d{2,4}\)?[-.\s]\d{3,4}[-.\s]\d{3,4}|\d{2,4}-\d{3,4}-\d{3,4}|\b\d{10}\b/g,url:/https?:\/\/[\w.-]+\.[\w]{2,}(\/[^\s]*)?/gi,linkedin:/linkedin\.com\/in\/[\w-]+/gi,twitter:/twitter\.com\/[\w]+/gi,facebook:/facebook\.com\/[\w.]+/gi,fax:/(?:fax|ÂÇ≥Áúü)[:Ôºö]?\s*(\+?\d{1,3}[-.\s]?)?\(?\d{2,4}\)?[-.\s]?\d{3,4}[-.\s]?\d{3,4}/gi,chineseTitle:/^(Ëë£‰∫ãÈï∑|Á∏ΩÁ∂ìÁêÜ|Âü∑Ë°åÈï∑|ÂâØÁ∏ΩÁ∂ìÁêÜ|ÂâØÁ∏ΩË£Å|Á∏ΩË£Å|Á∂ìÁêÜ|‰∏ª‰ªª|ÈÉ®Èï∑|Ë™≤Èï∑|ÁµÑÈï∑|Â∞àÂì°|‰∏ªÁÆ°|È°ßÂïè|Á∏ΩÁõ£)$/,titleKeywords:/(Ëë£‰∫ãÈï∑|Á∏ΩÁ∂ìÁêÜ|Âü∑Ë°åÈï∑|ÂâØÁ∏Ω|Á∏ΩË£Å|Á∂ìÁêÜ|‰∏ª‰ªª|ÈÉ®Èï∑|Ë™≤Èï∑|ÁµÑÈï∑|Â∞àÂì°|‰∏ªÁÆ°|È°ßÂïè|Á∏ΩÁõ£|.*Èï∑)$/,taxId:/(?:Áµ±Á∑®|Áµ±‰∏ÄÁ∑®Ëôü|Tax\s*ID)[:Ôºö]?\s*(\d{8})/gi,addressKeywords:/(?:Âú∞ÂùÄ|ÂùÄ|address|Â±ïÁ§∫È§®|Ëæ¶ÂÖ¨ÂÆ§|office)[:Ôºö]?\s*/gi,garbageChars:/[^\u4e00-\u9fff\w\s@.+\-()\/,;:Ôºö"]/g,repeatingChars:/(.)\1{4,}/g,excessiveSpaces:/\s{3,}/g};function pt(s){if(!s||s.length===0)return 0;let e=100;const r=(s.match(p.garbageChars)||[]).length;e-=r*5,p.repeatingChars.test(s)&&(e-=30),p.excessiveSpaces.test(s)&&(e-=20),s.length<2&&(e-=50),(s.match(/\d/g)||[]).length/s.length>.8&&!p.phone.test(s)&&(e-=20);const u=(s.match(/[\u4e00-\u9fff]/g)||[]).length;return u>0&&(e+=Math.min(u*2,20)),(p.email.test(s)||p.phone.test(s)||p.url.test(s))&&(e+=20),Math.max(0,Math.min(100,e))}function mt(s){let e=s;return e=e.replace(p.garbageChars,""),e=e.replace(p.excessiveSpaces," "),e=e.replace(/([^a-zA-Z0-9\u4e00-\u9fff])\1{2,}/g,"$1$1"),e.trim()}function vt(s){return s.map(e=>mt(e)).filter(e=>e.length===0?!1:pt(e)>=40)}function Fe(s){let e=s.replace(/[oO]/g,"0").replace(/[lI]/g,"1").replace(/[zZ]/g,"2").replace(/[sS]/g,"5");return e=e.replace(/[^\d\-+().\s]/g,""),e.trim()}function wt(s){const e=s.split(`
`).map(a=>a.trim()).filter(a=>a.length>0),r=vt(e),i={},c=/(inc\.|ltd\.|corp\.|limited|company|ÂÖ¨Âè∏|ÊúâÈôêÂÖ¨Âè∏|ËÇ°‰ªΩ|ÈõÜÂúò|‰ºÅÊ•≠)/i;if(r.length===1&&r[0]&&c.test(r[0]))return i.company=Q(r[0]),i;if(r.length===2&&r[0]&&r[1]&&c.test(r[0])&&/(?:Â∏Ç|ÂçÄ|Ë∑Ø|Ë°ó|Â∑∑|ÂºÑ|Ëôü|Ê®ì|street|road|avenue|floor)/i.test(r[1]))return i.company=Q(r[0]),i.address=r[1],i;const u=r.join(`
`),g=u.match(p.email);g&&g.length>0&&(i.email=g[0]);const k=u.match(p.phone);if(k&&k.length>0){const a=k.filter(l=>{const w=u.indexOf(l),R=u.substring(Math.max(0,w-10),w);if(/(fax|ÂÇ≥Áúü)/i.test(R))return!1;const d=u[w-1]||"",b=u[w+l.length]||"";return!(/\d/.test(d)||/\d/.test(b))});a.length>0&&a[0]&&(i.phone=Fe(a[0]))}const M=u.match(p.fax);if(M&&M.length>0){const a=M[0].replace(/(?:fax|ÂÇ≥Áúü)[:Ôºö]?\s*/gi,"").trim();i.fax=Fe(a)}const N=u.match(p.url);N&&N.length>0&&(i.website=N[0]);const E=[...u.match(p.linkedin)||[],...u.match(p.twitter)||[],...u.match(p.facebook)||[]];E.length>0&&(i.socialMedia=E.join(", "));const S=u.match(p.taxId);S&&S.length>0&&S[0].match(/\d{8}/);let T=!1;for(let a=0;a<Math.min(r.length,10);a++){const l=r[a];if(!l)continue;const w=/[\u4e00-\u9fff]/.test(l),R=/[A-Za-z]{2,}/.test(l);if(!(p.email.test(l)||p.phone.test(l)||p.url.test(l)||c.test(l))&&w&&R&&l.length<50){i.name=l,T=!0;break}}if(!T&&r.length>0&&r[0]){const a=r[0];a.length>3&&a.length<80&&!p.email.test(a)&&!p.phone.test(a)&&(i.name=a)}let q=!1;for(let a=0;a<Math.min(r.length,8);a++){const l=r[a];if(!l||i.name&&l===i.name||p.email.test(l)||p.phone.test(l)||p.url.test(l)||c.test(l))continue;const w=l.replace(/^[A-Za-z0-9]\s+/,"").trim();if(p.chineseTitle.test(w)){i.title=w,q=!0;break}if(p.titleKeywords.test(w)&&w.length<20){i.title=w,q=!0;break}}if(!q&&r.length>1&&r[1]){const a=r[1];a!==i.name&&a.length<60&&!p.email.test(a)&&!p.phone.test(a)&&!p.url.test(a)&&(i.title=a)}const $=r.find(a=>c.test(a));if($&&$.length<100)i.company=Q($);else for(let a=2;a<Math.min(r.length,6);a++){const l=r[a];if(l&&l.length>2&&l.length<100&&!p.email.test(l)&&!p.phone.test(l)&&!p.url.test(l)&&!p.chineseTitle.test(l.trim())&&l!==i.name&&l!==i.title&&(c.test(l)||l.length<50&&a<=3)){i.company=Q(l);break}}const L=r.filter(a=>{const l=/(?:Âú∞ÂùÄ|ÂùÄ|address|Â±ïÁ§∫È§®|Ëæ¶ÂÖ¨ÂÆ§|office)[:Ôºö]/i.test(a),w=/(?:Â∏Ç|ÂçÄ|Ë∑Ø|Ë°ó|Â∑∑|ÂºÑ|Ëôü|Ê®ì|street|road|avenue|floor)/i.test(a);return(l||w)&&a.length>10&&a.length<200&&!p.email.test(a)&&!p.phone.test(a)&&!p.url.test(a)&&a!==i.name&&a!==i.title&&a!==i.company});if(L.length>0){const a=L.map(l=>l.replace(p.addressKeywords,"").replace(/^[\/\\]+\s*/,"").trim());i.address=a[0]}else{const a=r.find(l=>l.length>20&&l.length<200&&!p.email.test(l)&&!p.phone.test(l)&&!p.url.test(l)&&l!==i.name&&l!==i.title&&l!==i.company);a&&(i.address=a.replace(/^[\/\\]+\s*/,"").trim())}return i}function Q(s){let e=s.trim();return e=e.replace(/^[\d\s\-_.,:;!?@#$%^&*()[\]{}|\\/<>~`'"]+/,""),e=e.replace(/^[A-Za-z]\s+/,""),e.trim()}class Lt{worker=null;initialized=!1;version="v3.0.0";async init(){if(!(this.initialized&&this.worker)){console.log(`üîç Tesseract OCR Adapter initializing... Version: ${this.version}`);try{this.worker=await gt.createWorker("chi_tra+eng",1,{errorHandler:e=>console.error("Tesseract error:",e),logger:e=>{e.status==="recognizing text"&&console.log(`OCR Progress: ${Math.round(e.progress*100)}%`)}}),await this.worker.setParameters({tessedit_pageseg_mode:6,preserve_interword_spaces:"1"}),this.initialized=!0,console.log("‚úÖ Tesseract OCR Adapter initialized successfully")}catch(e){throw console.error("Failed to initialize Tesseract worker:",e),new Error("OCR service initialization failed")}}}async isReady(){try{return await this.init(),this.initialized}catch{return!1}}async recognize(e,r){if(await this.init(),!this.worker)throw new Error("OCR worker not initialized");try{const i=await this.preprocessImage(e),c=await this.worker.recognize(i);r&&r(100);const u=c.data.text,g=c.data.confidence;console.log(`üìä Tesseract Adapter ${this.version} - Confidence: ${g}%`),console.log("OCR Raw Text:",u);const k=wt(u);return{text:u,confidence:g,extractedData:k}}catch(i){throw console.error("OCR recognition failed:",i),new Error("Failed to process image with OCR")}}async preprocessImage(e){return new Promise((r,i)=>{const c=new Image,u=URL.createObjectURL(e);c.onload=()=>{try{const g=document.createElement("canvas"),k=g.getContext("2d");if(!k){i(new Error("Could not get canvas context"));return}const M=2;g.width=c.width*M,g.height=c.height*M,k.drawImage(c,0,0,g.width,g.height);const N=k.getImageData(0,0,g.width,g.height),E=N.data,S=new Uint8Array(E.length/4);for(let d=0,b=0;d<E.length;d+=4,b++){const A=E[d]??0,D=E[d+1]??0,j=E[d+2]??0;S[b]=Math.round(.299*A+.587*D+.114*j)}const T=new Array(256).fill(0);S.forEach(d=>T[d]++);const q=S.length;let $=0;for(let d=0;d<256;d++)$+=d*T[d];let L=0,a=0,l=0,w=0,R=128;for(let d=0;d<256;d++){if(a+=T[d],a===0)continue;if(l=q-a,l===0)break;L+=d*T[d];const b=L/a,A=($-L)/l,D=a*l*(b-A)*(b-A);D>w&&(w=D,R=d)}R=Math.min(R+20,255);for(let d=0,b=0;d<E.length;d+=4,b++){const A=(S[b]??0)>R?255:0;E[d]=A,E[d+1]=A,E[d+2]=A}k.putImageData(N,0,0),URL.revokeObjectURL(u),r(g)}catch(g){URL.revokeObjectURL(u),i(g)}},c.onerror=()=>{URL.revokeObjectURL(u),i(new Error("Failed to load image for preprocessing"))},c.src=u})}async terminate(){this.worker&&(await this.worker.terminate(),this.worker=null,this.initialized=!1,console.log("üîÑ Tesseract OCR Adapter terminated"))}}export{Lt as TesseractAdapter};
